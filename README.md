プロジェクト概要：中古マンション取引価格予測モデルの構築
1. プロジェクトの目的
本プロジェクトは、NISHIKA（データ分析コンペティションプラットフォーム）に提出する中古マンションの取引価格予測モデルを構築することを目的としています。
提供された多岐にわたるデータから適切な特徴量を抽出し、機械学習モデルを用いて精度の高い価格予測を目指しました。

2. データについて
株式会社リクルートが提供する「不動産取引価格データ」と、独自に収集した「都道府県別人口密度データ」を使用しました。
データには、面積、建築年、最寄駅からの距離、間取り、建物の構造、地域情報など、マンションの価格に影響を与えると考えられる多様な情報が含まれています。

3. 使用技術・ライブラリ
Python: データ分析、モデル構築全般
Pandas: データ処理、整形
NumPy: 数値計算
scikit-learn: データ分割、標準化
statsmodels: OLS（最小二乗法）モデルの構築
Matplotlib, japanize-matplotlib: 結果の可視化

4. アプローチ・手法
4.1. データ前処理 (preprocess_data 関数)
データの品質向上とモデル学習に適した形式への変換のため、以下の前処理を行いました。
・不要な列の削除: 予測に直接関係のないIDや重複情報を持つ列を削除しました。
・間取り情報の詳細化: 「LDKあり」「DKのみ」「Kのみ」「Rのみ」「Sあり」「特殊間取り」「部屋数」といった、
　間取りに含まれる情報を複数のフラグや数値特徴量に分解し、より詳細な情報をモデルに与えました。
・建物構造のカテゴリ化: 「SRC」「RC」などの主要な建物構造をダミー変数化しました。
・都道府県別人口密度データの結合: 外部データとして、都道府県ごとの人口密度を結合し、
　地域特性を考慮した特徴量を追加しました。
・面積データの整形と対数変換: 「㎡以上」といった文字列を削除し数値化、
　さらに極端な値の影響を軽減するために対数変換を行いました。
・建築年・築年数の計算: 和暦表記の建築年を西暦に変換し、現在の年からの築年数を計算しました。
・欠損値補完:
　・取引価格（総額）_log の欠損値を持つ行や0以下の価格のデータを削除しました。
　・建築年_西暦 や 最寄駅：距離（分）、建ぺい率（％）、容積率（％） の欠損値は、最寄駅ごとの平均値、
　　またはデータ全体の中央値で補完し、情報の欠落を最小限に抑えました。
・最寄駅：距離（分）の数値変換: 「1H~」といった時間表記を数値（分）に変換し、連続値として扱えるようにしました。
・カテゴリカル変数のエンコーディング:
　・都道府県名: サンプル数の多い主要な都道府県（例: 東京都、神奈川県など）を抽出し、ダミー変数化しました。
　・都市計画: 主要な都市計画区分をダミー変数化しました。
・フラグ特徴量の作成: 「取引の事情等」「改装」「用途」「今後の利用目的」から、
　それぞれ「事情あり」「改装済」「住宅フラグ」「店舗フラグ」などのバイナリ特徴量を作成しました。
・交互作用特徴量の追加: 建ぺい率 × 容積率、面積 × 人口密度、駅距離 × 人口密度、築年数 × 改装済フラグ といった、
　既存の特徴量を組み合わせた新しい特徴量を作成し、モデルの表現力を高めました。

4.2. モデル構築と学習
・モデル選択: 線形回帰モデルの一種であるOLS (Ordinary Least Squares: 最小二乗法) を採用しました。
・データ分割: 前処理済みの訓練データをさらに訓練用と検証用に分割しました（train_test_split）。
・特徴量の標準化: 各特徴量のスケールを統一するため、StandardScalerを用いて標準化を行いました。
　これにより、モデルが特定の大きな値を持つ特徴量に過度に影響されることを防ぎます。
・モデルの学習: statsmodels.api.OLS を用いて、標準化された訓練データでモデルを学習させました。

4.3. 予測と評価（コメントアウト部）
・学習済みモデルを用いてテストデータの価格予測を行いました。
・OLSモデルの学習結果から、results.summary() を表示し、
　モデルの統計的な詳細（R-squared, p-value, 係数など）を確認しました。
・各特徴量の回帰係数の絶対値を可視化することで、どの特徴量が予測に大きく寄与しているかを分析しました。
・VIF (Variance Inflation Factor: 分散拡大要因) を計算し、多重共線性の有無を確認しました。

5. 結果
本モデルの決定係数は0.724。NISHIKAコンペティションでは、3233人中189位の成績でした。
最終的に予測された対数価格を元のスケールに戻し、提出フォーマットに合わせた sample_submission_v31_ols.csv を出力しました。

7. 今後の展望・改善点
モデルの改善: OLS以外のより高度なモデル（例: LightGBM, XGBoost, Random Forestなど）の導入を検討し、予測精度の向上を図る。
特徴量エンジニアリングの深掘り: 更なるドメイン知識に基づいた特徴量の生成や、交互作用特徴量の追加。
ハイパーパラメータチューニング: モデルの性能を最大化するためのハイパーパラメータの最適化。
アンサンブル学習: 複数のモデルの予測結果を組み合わせることで、よりロバストな予測モデルを構築。
